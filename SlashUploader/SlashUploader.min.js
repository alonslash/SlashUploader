/*
 * SlashUploader - JS plugin - Version 1.5.1
 * Copyright (c) 2018 Slash Apps Development, http://slash.co.il/
 * Licensed under the MIT License [https://en.wikipedia.org/wiki/MIT_License]
 */

function FileData(e){this.file,this.name,this.size,this.duration,this.width,this.height,this.extension,this.init=function(e){this.file=e;var n=e.name;null==n&&(n=""),this.name=n,this.size=e.size,this.extension=n.substr(n.lastIndexOf(".")+1,5).toLowerCase()},this.init(e)}function SlashUploader(e,n){this.opts=n,this._internalVariables={},this._internalVariables.instance=this,this._internalVariables.hoverOnBtn=!1,this._internalVariables.draggedOnBtn=!1,this._internalVariables.isUploading=!1,this._internalVariables.draggedOnDocument=!1,this._internalVariables.curUploadingFileIndex=0,this._internalVariables.curUploadingFilesData=[],this._internalVariables.totalFilesToUpload=0,this._internalVariables.BYTES_PER_CHUNK=77570,this._internalVariables.curMouseX=-1,this._internalVariables.lastMouseX=-1,this._internalVariables.curMouseY=-1,this._internalVariables.lastMouseY=-1,this._internalVariables.uploadFileChunkXhr=null,this._internalVariables.displayErrorAnimationTimeoutDuration,this._internalVariables.onChangeTriggered=!1,this._internalVariables.setVariable=function(e){var n=this.instance;"acceptOnlyFilesTypes"==e?noJquery(n.elements.uploaderInputElement).attr("accept",n.acceptOnlyFilesTypes):"maxFiles"==e?n.maxFiles>1?null!=n.elements.uploaderInputElement&&noJquery(n.elements.uploaderInputElement).attr("multiple","multiple"):null!=n.elements.uploaderInputElement&&noJquery(n.elements.uploaderInputElement).removeAttr("multiple"):"showUploadedFiles"==e?n.showUploadedFiles?(noJquery(n.elements.uploaderResultWrapperElement).attr("style",""),noJquery(n.elements.uploaderDropAreaWrapper).attr("style","")):(noJquery(n.elements.uploaderResultWrapperElement).attr("style","width: 0px; display: none;"),noJquery(n.elements.uploaderDropAreaWrapper).attr("style","width: 100%;")):"disabled"==e?n.disabled?(noJquery(n.elements.containerElement).addClass("disabled"),noJquery(n.elements.uploaderDropAreaElement).find(".input_wrapper").css("display","none")):(noJquery(n.elements.containerElement).removeClass("disabled"),noJquery(n.elements.uploaderDropAreaElement).find(".input_wrapper").css("display","")):"rtl"==e?n.rtl?noJquery("#"+n.elements.elementId).addClass("rtl"):noJquery("#"+n.elements.elementId).removeClass("rtl"):"enableDropFiles"==e?n._internalVariables.setDropFileEvents():"progressAnimationType"==e?n._internalVariables.setProgressDisplay():"maxFileChars"!=e&&"uploadedFiles"!=e||n._internalVariables.showCurrentFiles(),n._internalVariables.setText()};var a={};if(Object.defineProperty(this,"acceptOnlyFilesTypes",{get:function(){return a.acceptOnlyFilesTypes},set:function(e){a.acceptOnlyFilesTypes=e,this._internalVariables.setVariable("acceptOnlyFilesTypes")}}),Object.defineProperty(this,"showUploadedFiles",{get:function(){return a.showUploadedFiles},set:function(e){a.showUploadedFiles=e,this._internalVariables.setVariable("showUploadedFiles")}}),Object.defineProperty(this,"disabled",{get:function(){return a.disabled},set:function(e){a.disabled=e,this._internalVariables.setVariable("disabled")}}),Object.defineProperty(this,"enableDropFiles",{get:function(){return a.enableDropFiles},set:function(e){a.enableDropFiles=e,this._internalVariables.setVariable("enableDropFiles")}}),Object.defineProperty(this,"maxFiles",{get:function(){return a.maxFiles},set:function(e){a.maxFiles=e,this._internalVariables.setVariable("maxFiles")}}),Object.defineProperty(this,"progressAnimationType",{get:function(){return a.progressAnimationType},set:function(e){a.progressAnimationType=e,this._internalVariables.setVariable("progressAnimationType")}}),Object.defineProperty(this,"maxFileChars",{get:function(){return a.maxFileChars},set:function(e){a.maxFileChars=e,this._internalVariables.setVariable("maxFileChars")}}),Object.defineProperty(this,"uploadedFiles",{get:function(){return a.uploadedFiles},set:function(e){a.uploadedFiles=e,this._internalVariables.setVariable("uploadedFiles")}}),Object.defineProperty(this,"browseText",{get:function(){return a.browseText},set:function(e){a.browseText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"browseTextDropDisabled",{get:function(){return a.browseTextDropDisabled},set:function(e){a.browseTextDropDisabled=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"rtl",{get:function(){return a.rtl},set:function(e){a.rtl=e,this._internalVariables.setVariable("rtl")}}),Object.defineProperty(this,"dropFilesText",{get:function(){return a.dropFilesText},set:function(e){a.dropFilesText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadingFileText",{get:function(){return a.uploadingFileText},set:function(e){a.uploadingFileText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadingFileTextProgressBar",{get:function(){return a.uploadingFileTextProgressBar},set:function(e){a.uploadingFileTextProgressBar=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadingFilesText",{get:function(){return a.uploadingFilesText},set:function(e){a.uploadingFilesText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadingFilesTextProgressBar",{get:function(){return a.uploadingFilesTextProgressBar},set:function(e){a.uploadingFilesTextProgressBar=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadingFileByFileText",{get:function(){return a.uploadingFileByFileText},set:function(e){a.uploadingFileByFileText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"uploadedFileHtml",{get:function(){return a.uploadedFileHtml},set:function(e){a.uploadedFileHtml=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"cancelText",{get:function(){return a.cancelText},set:function(e){a.cancelText=e,this._internalVariables.setVariable()}}),Object.defineProperty(this,"serverScripts",{get:function(){return a.serverScripts},set:function(e){var n=this.serverScripts;noJquery.extend(n,e),a.serverScripts=n}}),this.onFilesSelected=null,this.onFilesUploaded=null,this.onFileDeleted=null,this.onFilesProgress=null,this.onCanceled=null,this.onError=null,this.customValidation=null,this.customHTML=!1,this.uploadFileInChunks=!0,this.resetFilesOnEachUpload=!0,this.iframeGateway="./SlashUploader/iframe_gateway.html",this.doGetFileMetadata=!0,this.allowedFilesExtensions=null,this.allowedMaxFileSize=null,this.showDetailedErrorFromServer=!0,this.displayErrorDuration=4500,a.serverScripts={uploadChunk:"./SlashUploader/server/UploadFiles.aspx?method=upload_chunk&file_name={{file_name}}&chunk_index={{chunk_index}}&request_id={{request_id}}",combineChunks:"./SlashUploader/server/UploadFiles.aspx?method=combine_chunks&rotation={{rotation}}&file_name={{file_name}}&request_id={{request_id}}",uploadStream:"./SlashUploader/server/UploadFiles.aspx?method=upload_stream&rotation={{rotation}}&file_name={{file_name}}",uploadThroughIframe:"./SlashUploader/server/UploadFiles.aspx?method=upload_through_iframe&rotation={{rotation}}&request_id={{request_id}}&iframe_gateway={{iframe_gateway}}",fileNameVariableName:"file_name",fileUrlVariableName:"file_path",errorVariableName:"error"},a.showUploadedFiles=!0,a.disabled=!1,a.enableDropFiles=!0,a.maxFiles=9999,a.progressAnimationType="inline",a.maxFileChars=22,a.uploadedFiles=[],a.browseText="Drop files here or click to upload",a.browseTextDropDisabled="Click to upload",a.dropFilesText="Drop files here",a.uploadingFileText='Uploading "{{current_file_name}}"',a.uploadingFileTextProgressBar='Uploading "{{current_file_name}}"',a.uploadingFilesText="Uploading {{total_files}} files",a.uploadingFilesTextProgressBar="Uploading {{total_files}} files",a.uploadingFileByFileText='Uploading "{{current_file_name}}" ({{current_file_index}}/{{total_files}})',a.uploadedFileHtml="<a href='{{current_file_path}}' target='_blank'>{{current_file_name}}</a>",a.cancelText="Cancel",this.elements={},this.elements.elementId="uploader_"+Math.floor(999999999*Math.random()),this.elements.containerElement=e,this.elements.uploaderDropAreaElement=null,this.elements.uploaderTextElement=null,this.elements.uploaderDropAreaWrapper=null,this.elements.uploaderDropAreaBottomLayerElement=null,this.elements.uploaderDropAreaMiddleLayerElement=null,this.elements.uploaderResultWrapperElement=null,this.elements.uploaderResultElement=null,this.elements.uploaderProgressContainerElement=null,this.elements.uploaderProgressBarElement=null,this.elements.uploaderProgressBarPaddingElement=null,this.elements.uploaderProgressBarTextElement=null,this.elements.uploaderProgressBarColorElement=null,this.elements.uploaderInputElement=null,this.elements.uploaderCancelButton=null,this.errors={},this.errors.invalidFileExtension="Invalid file extension ({{file_name}})",this.errors.invalidFileSize="Invalid file size ({{file_name}})",this.errors.uploadFailed="Failed to upload",this.errors.unspecifiedError="Unspecified error",-1!=navigator.appVersion.indexOf("MSIE")&&8==parseFloat(navigator.appVersion.split("MSIE")[1])){var t=this,r=a.serverScripts,i={};setTimeout(function(){!function e(){i.acceptOnlyFilesTypes!=t.acceptOnlyFilesTypes&&t._internalVariables.setVariable("acceptOnlyFilesTypes"),i.showUploadedFiles!=t.showUploadedFiles&&t._internalVariables.setVariable("showUploadedFiles"),i.disabled!=t.disabled&&t._internalVariables.setVariable("disabled"),i.enableDropFiles!=t.enableDropFiles&&t._internalVariables.setVariable("enableDropFiles"),i.maxFiles!=t.maxFiles&&t._internalVariables.setVariable("maxFiles"),i.progressAnimationType!=t.progressAnimationType&&t._internalVariables.setVariable("progressAnimationType"),i.maxFileChars!=t.maxFileChars&&t._internalVariables.setVariable("maxFileChars"),i.uploadedFiles!=t.uploadedFiles&&t._internalVariables.setVariable("uploadedFiles"),i.rtl!=t.rtl&&t._internalVariables.setVariable("rtl"),t._internalVariables.setVariable(),i.acceptOnlyFilesTypes=t.acceptOnlyFilesTypes,i.showUploadedFiles=t.showUploadedFiles,i.disabled=t.disabled,i.enableDropFiles=t.enableDropFiles,i.maxFiles=t.maxFiles,i.progressAnimationType=t.progressAnimationType,i.maxFileChars=t.maxFileChars,i.uploadedFiles=t.uploadedFiles,i.rtl=t.rtl,noJquery.extend(r,t.serverScripts),t.serverScripts=r,setTimeout(function(){e()},3e3)}()},250)}this._internalVariables.build=function(){var e=this.instance,n=e._internalVariables.getIEVersion();if(n>=0&&n<=8)for(var t in a)e[t]=a[t];if(null!=e.opts&&(noJquery.extend(e.errors,e.opts.errors),delete e.opts.errors,noJquery.extend(e.serverScripts,e.opts.serverScripts),delete e.opts.serverScripts,noJquery.extend(e,e.opts)),null!=e.elements.containerElement){for(var r=e.elements.containerElement,i=r.tagName.toUpperCase(),l=!1;"BODY"!=i&&!l;)"FORM"==(i=(r=r.parentElement).tagName.toUpperCase())&&(l=!0);if(l)e._internalVariables.consoleError("Can't create element inside 'form' tag.");else{var s='<form id="'+e.elements.elementId+'" name="'+e.elements.elementId+'" class="uploader_form">';e.customHTML?(s+='<div class="uploader_drop_area_custom">',s+="</div>"):(s+='<div class="uploader_div">',s+='\t<div class="uploader_drop_area_wrapper">',s+='\t\t<div class="uploader_drop_area_bottom_bg"></div>',s+='\t\t<div class="uploader_drop_area_bottom"><img /></div>',s+='\t\t<div class="uploader_drop_area_middle"><img /></div>',s+='\t\t<div class="uploader_drop_area">',s+='\t\t\t<div class="uploader_text"><span><div class="uploader_spinner"></div><span></span></span></div>',s+='\t\t\t<div class="uploader_cancel"><span></span></div>',s+="\t\t</div>",s+="\t</div>",s+='\t<div class="uploader_result_wrapper"><div class="uploader_result"></div></div>',s+="</div>",s+='<div class="uploader_progress_container" style="display: none;">',s+="\t<table><tr>",s+='\t\t<td class="uploader_progress_bar_loading"><div class="uploader_spinner"></div><span></span></td>',s+='\t\t<td class="uploader_progress_bar_loading_padding"></td>',s+='\t\t<td class="uploader_progress_bar"><div><div></div></div></td>',s+='\t\t<td class="uploader_progress_bar_padding"></td>',s+='\t\t<td class="uploader_progress_bar_text"></td>',s+="\t</tr></table>",s+="</div>"),s+="</form>",e.customHTML?(noJquery(e.elements.containerElement).css("position","relative"),noJquery(e.elements.containerElement).html(s+noJquery(e.elements.containerElement).html())):noJquery(e.elements.containerElement).html(s),noJquery(e.elements.containerElement).addClass("slash_uploader"),(e.customHTML||n>=0&&n<=8)&&noJquery(e.elements.containerElement).on("mousemove",function(n){var a=this;null!=noJquery(this).find(".uploader_drop_area_wrapper")[0]&&(a=noJquery(this).find(".uploader_drop_area_wrapper")[0]),noJquery(e.elements.uploaderDropAreaElement).find("input").css("left",n.pageX-noJquery(a).offset().left-120),noJquery(e.elements.uploaderDropAreaElement).find("input").css("top",n.pageY-noJquery(a).offset().top-20)}),e.customHTML?e.elements.uploaderDropAreaElement=noJquery(e.elements.containerElement).find(".uploader_drop_area_custom").get(0):e.elements.uploaderDropAreaElement=noJquery(e.elements.containerElement).find(".uploader_drop_area").get(0),e.elements.uploaderTextElement=noJquery(e.elements.containerElement).find(".uploader_drop_area").find(".uploader_text span").get(0),e.elements.uploaderDropAreaWrapper=noJquery(e.elements.containerElement).find(".uploader_drop_area_wrapper").get(0),e.elements.uploaderDropAreaBottomLayerElement=noJquery(e.elements.containerElement).find(".uploader_drop_area_bottom").get(0),e.elements.uploaderDropAreaMiddleLayerElement=noJquery(e.elements.containerElement).find(".uploader_drop_area_middle").get(0),e.elements.uploaderResultElement=noJquery(e.elements.containerElement).find(".uploader_result").get(0),e.elements.uploaderResultWrapperElement=noJquery(e.elements.containerElement).find(".uploader_result_wrapper").get(0),e.elements.uploaderProgressContainerElement=noJquery(e.elements.containerElement).find(".uploader_progress_container").get(0),e.elements.uploaderProgressBarElement=noJquery(e.elements.containerElement).find(".uploader_progress_bar").get(0),e.elements.uploaderProgressBarPaddingElement=noJquery(e.elements.containerElement).find(".uploader_progress_bar_padding").get(0),e.elements.uploaderProgressBarTextElement=noJquery(e.elements.containerElement).find(".uploader_progress_bar_text").get(0),e.elements.uploaderProgressBarColorElement=noJquery(e.elements.containerElement).find(".uploader_progress_container .uploader_progress_bar div div").get(0),e.elements.uploaderCancelButton=noJquery(e.elements.containerElement).find(".uploader_cancel").get(0),e._internalVariables.buildFileInput(),e._internalVariables.setProgressDisplay(),e._internalVariables.setText(),e._internalVariables.setDocumentEvents(),e._internalVariables.setDropFileEvents(),e._internalVariables.showCurrentFiles(),noJquery(e.elements.uploaderCancelButton).on("click",function(){e.cancelUpload()}),e._internalVariables.validateIframeGatewayPath()}}else e._internalVariables.consoleError("Element not exist in DOM.")},this._internalVariables.setProgressDisplay=function(){var e=this.instance;null!=e.elements.containerElement&&(null==e.progressAnimationType&&(e.progressAnimationType=""),-1!=e.progressAnimationType.indexOf("bar")?(noJquery(e.elements.containerElement).addClass("loading_bar"),e._internalVariables.isUploading&&null!=e.elements.uploaderProgressContainerElement&&noJquery(e.elements.uploaderProgressContainerElement).css("display","")):(noJquery(e.elements.containerElement).removeClass("loading_bar"),null!=e.elements.uploaderProgressContainerElement&&noJquery(e.elements.uploaderProgressContainerElement).css("display","none")),null!=e.elements.uploaderDropAreaBottomLayerElement&&(-1==e.progressAnimationType.indexOf("inline")||!e._internalVariables.isUploading||"chunks"!=e._internalVariables.getUploadType()&&"stream"!=e._internalVariables.getUploadType()?(noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("display","none"),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).css("display","none")):(noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("display",""),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).css("display",""))))},this._internalVariables.validateFiles=function(){for(var e=this.instance,n=[],a=0;a<e._internalVariables.curUploadingFilesData.length;a++){var t=e._internalVariables.curUploadingFilesData[a],r=(t.name,t.extension),i=t.size/1024;if(null!=e.allowedFilesExtensions&&e.allowedFilesExtensions.length>0&&-1==noJquery.inArray(r.toLowerCase(),e.allowedFilesExtensions)?n.push({error:"invalid_file_extension",file:t}):null!=e.allowedMaxFileSize&&e.allowedMaxFileSize>0&&i>e.allowedMaxFileSize&&n.push({error:"invalid_file_size",file:t}),0==n.length&&null!=e.allowedMaxFileSize&&e.allowedMaxFileSize>0){var l=e._internalVariables.getIEVersion();l>0&&l<=9&&e._internalVariables.consoleError("Size validation is not possible on IE9 and below")}if("function"==typeof e.customValidation){var s=e.customValidation(t);null!=s&&(s.file=t.file,n.push(s))}}return n},this._internalVariables.buildFileInput=function(){var e=this.instance;noJquery(e.elements.uploaderDropAreaElement).find(".input_wrapper").remove(),noJquery(e.elements.uploaderDropAreaElement).append(noJquery("<div class='input_wrapper'><input name='"+e.elements.elementId+"_input' type='file' "+(e.maxFiles>1?"multiple":"")+" /></div>")[0]);var n=noJquery(e.elements.containerElement).find("input")[0];null!=n&&(n.onchange=function(){e._internalVariables.onChangeTriggered=!0;var n=this.files;if(null==n){var a={},t=this.value;null!=t&&""!=t&&(-1!=t.indexOf("/")&&(t=t.substr(t.lastIndexOf("/")+1)),-1!=t.indexOf("\\")&&(t=t.substr(t.lastIndexOf("\\")+1)),a.name=t),n=[a]}if(noJquery(e.elements.uploaderDropAreaElement).find("input").css("display","none"),!e._internalVariables.isUploading&&n){e._internalVariables.curUploadingFilesData=[];for(var r=0;r<n.length;r++){a=n[r];e._internalVariables.curUploadingFilesData.push(new FileData(a))}e._internalVariables.totalFilesToUpload=Math.min(n.length,e.maxFiles),e._internalVariables.traverseFiles()}setTimeout(function(){e._internalVariables.onChangeTriggered=!1},1)},n.onmouseover=function(){e._internalVariables.hoverOnBtn=!0,e._internalVariables.checkDragFileStates()},n.onmouseout=function(){e._internalVariables.hoverOnBtn=!1,e._internalVariables.checkDragFileStates()}),e.elements.uploaderInputElement=noJquery(e.elements.containerElement).find("input")[0],e._internalVariables.setVariable("acceptOnlyFilesTypes"),e._internalVariables.setVariable("showUploadedFiles"),e._internalVariables.setVariable("disabled"),e._internalVariables.setVariable("rtl"),e._internalVariables.checkDragFileStates()},this._internalVariables.showUploadBtn=function(){var e=this.instance;noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("display","none"),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).css("display","none"),noJquery(e.elements.containerElement).removeClass("uploading"),noJquery(e.elements.containerElement).find("input").attr("onclick",""),e._internalVariables.setText(),e._internalVariables.buildFileInput(),noJquery(e.elements.uploaderProgressContainerElement).css("display","none"),noJquery(e.elements.uploaderProgressBarColorElement).css("width","0%"),noJquery(e.elements.uploaderCancelButton).css("display","none")},this._internalVariables.setDropFileEvents=function(){var e=this.instance;null!=e.elements.uploaderDropAreaElement&&(noJquery(e.elements.uploaderDropAreaElement).unbind("dragleave"),noJquery(e.elements.uploaderDropAreaElement).unbind("dragenter, dragover"),noJquery(e.elements.uploaderDropAreaElement).unbind("drop"),e._internalVariables.isDropFilesEnabled()&&(noJquery(e.elements.uploaderDropAreaElement).on("dragleave",function(n){e.disabled||(e._internalVariables.draggedOnBtn=!1,e._internalVariables.checkDragFileStates(),n.preventDefault(),n.stopPropagation())}),noJquery(e.elements.uploaderDropAreaElement).on("dragenter, dragover",function(n){e.disabled||e._internalVariables.isUploading||!e._internalVariables.isDropFilesEnabled()||"Files"!=n.originalEvent.dataTransfer.types[0]&&"text/uri-list"!=n.originalEvent.dataTransfer.types[0]&&"application/x-moz-file"!=n.originalEvent.dataTransfer.types[0]||(e._internalVariables.draggedOnBtn=!0,e._internalVariables.checkDragFileStates(),n.preventDefault(),n.stopPropagation())}),noJquery(e.elements.uploaderDropAreaElement).on("drop",function(n){if(!e.disabled&&!e._internalVariables.isUploading&&e._internalVariables.isDropFilesEnabled()){e._internalVariables.draggedOnBtn=!1,e._internalVariables.draggedOnDocument=!1,e._internalVariables.checkDragFileStates();var a=n.originalEvent.dataTransfer.files;e._internalVariables.curUploadingFilesData=[];for(var t=0;t<a.length;t++){var r=a[t];e._internalVariables.curUploadingFilesData.push(new FileData(r))}e._internalVariables.totalFilesToUpload=Math.min(a.length,e.maxFiles),noJquery(e.elements.uploaderDropAreaElement).find("input").css("display","none"),"iframe"==e._internalVariables.getUploadType()?(noJquery(e.elements.uploaderDropAreaElement).find("input")[0].files=n.originalEvent.dataTransfer.files,e._internalVariables.onChangeTriggered||setTimeout(function(){try{var n=new Event("change");noJquery(e.elements.uploaderDropAreaElement).find("input")[0].dispatchEvent(n)}catch(e){}},1)):e._internalVariables.traverseFiles(),n.preventDefault(),n.stopPropagation()}})))},this._internalVariables.setDocumentEvents=function(){var e=this.instance;e._internalVariables.isDropFilesEnabled()&&(document.addEventListener("mousemove",function(n){e._internalVariables.curMouseX=n.clientX,e._internalVariables.curMouseY=n.clientY},!1),document.addEventListener("dragover",function(n){e.disabled||"Files"!=n.dataTransfer.types[0]&&"text/uri-list"!=n.dataTransfer.types[0]&&"application/x-moz-file"!=n.dataTransfer.types[0]||n.dataTransfer&&(n.dataTransfer.dropEffect="none",n.preventDefault())},!1),document.addEventListener("drop",function(n){e.disabled||e._internalVariables.isUploading||!e._internalVariables.isDropFilesEnabled()||"Files"!=n.dataTransfer.types[0]&&"text/uri-list"!=n.dataTransfer.types[0]&&"application/x-moz-file"!=n.dataTransfer.types[0]||(e._internalVariables.draggedOnDocument=!1,e._internalVariables.draggedOnBtn=!1,e._internalVariables.checkDragFileStates(),n.preventDefault(),n.stopPropagation())},!1),document.addEventListener("dragenter",function(n){e.disabled||e._internalVariables.isUploading||!e._internalVariables.isDropFilesEnabled()||"Files"!=n.dataTransfer.types[0]&&"text/uri-list"!=n.dataTransfer.types[0]&&"application/x-moz-file"!=n.dataTransfer.types[0]||(e._internalVariables.draggedOnDocument=!0,e._internalVariables.checkDragFileStates())},!1),noJquery("body").on("mouseleave",function(){e._internalVariables.draggedOnDocument=!1,e._internalVariables.draggedOnBtn=!1,e.disabled||e._internalVariables.isUploading||!e._internalVariables.isDropFilesEnabled()||e._internalVariables.checkDragFileStates()}),setInterval(e._internalVariables.checkMousePosition,100,e))},this._internalVariables.checkDragFileStates=function(){var e=this.instance;null!=e.elements.containerElement&&(e.disabled||e._internalVariables.isUploading||(noJquery(e.elements.containerElement).removeClass("dragged_enter"),noJquery(e.elements.containerElement).removeClass("dragged_over"),noJquery(e.elements.containerElement).removeClass("hover"),noJquery(e.elements.containerElement).removeClass("uploading"),e._internalVariables.draggedOnBtn?noJquery(e.elements.containerElement).addClass("dragged_over"):e._internalVariables.draggedOnDocument?noJquery(e.elements.containerElement).addClass("dragged_enter"):e._internalVariables.hoverOnBtn&&noJquery(e.elements.containerElement).addClass("hover"))),e._internalVariables.setText()},this._internalVariables.checkMousePosition=function(e){(Math.abs(e._internalVariables.curMouseX-e._internalVariables.lastMouseX)>5||Math.abs(e._internalVariables.curMouseY-e._internalVariables.lastMouseY)>5)&&(e._internalVariables.draggedOnDocument=!1,e._internalVariables.checkDragFileStates()),e._internalVariables.lastMouseX=e._internalVariables.curMouseX,e._internalVariables.lastMouseY=e._internalVariables.curMouseY},this._internalVariables.setText=function(){var e=this.instance;null!=e.elements.containerElement&&null!=e.elements.uploaderTextElement&&(e.disabled||e._internalVariables.isUploading?e._internalVariables.isUploading?(noJquery(e.elements.uploaderTextElement).find("span").html(e._internalVariables.getUploadingText()),noJquery(e.elements.uploaderTextElement).find(".uploader_spinner").css("display","")):(noJquery(e.elements.uploaderTextElement).find("span").html(e._internalVariables.isDropFilesEnabled()?e.browseText:e.browseTextDropDisabled),noJquery(e.elements.uploaderTextElement).find(".uploader_spinner").css("display","none")):(e._internalVariables.draggedOnBtn?noJquery(e.elements.uploaderTextElement).find("span").html(e.dropFilesText):e._internalVariables.draggedOnDocument?noJquery(e.elements.uploaderTextElement).find("span").html(e.dropFilesText):(e._internalVariables.hoverOnBtn,noJquery(e.elements.uploaderTextElement).find("span").html(e._internalVariables.isDropFilesEnabled()?e.browseText:e.browseTextDropDisabled)),noJquery(e.elements.uploaderTextElement).find(".uploader_spinner").css("display","none")),noJquery(e.elements.uploaderCancelButton).find("span").html(e.cancelText))},this._internalVariables.getUploadingText=function(){var e=this.instance,n="",a=Math.min(e._internalVariables.curUploadingFilesData.length,e.maxFiles);return n=(n="chunks"==e._internalVariables.getUploadType()||"stream"==e._internalVariables.getUploadType()?null==e._internalVariables.curUploadingFilesData||e._internalVariables.curUploadingFilesData.length<=1||1==e.maxFiles?e.uploadingFileText:e.uploadingFileByFileText:1==a?e.uploadingFileText:e.uploadingFilesText).split("{{current_file_index}}").join(e._internalVariables.curUploadingFileIndex+1),n=(n=e._internalVariables.curUploadingFilesData.length>e._internalVariables.curUploadingFileIndex?n.split("{{current_file_name}}").join(e._internalVariables.getShortFilename(e._internalVariables.curUploadingFilesData[e._internalVariables.curUploadingFileIndex].name)):n.split("{{current_file_name}}").join("")).split("{{total_files}}").join(a)},this._internalVariables.getShortFilename=function(e){var n=this.instance,a=e;a=(a=(a=a.substring(a.lastIndexOf("/")+1,a.length)).substring(a.lastIndexOf("\\")+1,a.length)).substring(0,a.lastIndexOf("."));var t=e.substring(e.lastIndexOf("."),e.length);return a.length+t.length+1>n.maxFileChars&&(a=a.substring(0,n.maxFileChars-3-t.length)+"..."),a+t},this._internalVariables.traverseFiles=function(){var e=this.instance;void 0!==e._internalVariables.curUploadingFilesData&&e._internalVariables.curUploadingFilesData.length>0&&(e.resetFilesOnEachUpload&&(e.uploadedFiles=[]),e._internalVariables.curUploadingFileIndex=0,e._internalVariables.getFilesMetadata())},this._internalVariables.getFilesMetadata=function(){this.instance._internalVariables.getNextFileMetadata()},this._internalVariables.getNextFileMetadata=function(){var e=this.instance,n=e._internalVariables.curUploadingFilesData[e._internalVariables.curUploadingFileIndex].file,a=n.name;null==a&&(a="");var t={file:n,name:a,size:n.size,extension:a.substr(a.lastIndexOf(".")+1,5),type:n.type,width:null,height:null,rotation:null,duration:null};if(e._internalVariables.isImg(n.name)&&e.doGetFileMetadata)"undefined"!=typeof FileReader?setTimeout(function(){var r=new FileReader,i=setTimeout(function(){r.onload=null,e._internalVariables.consoleError("Failed retrieving meta data for '"+a+"'"),e._internalVariables.getFileMetaFinished(n,t)},400);r.onload=function(n){e._internalVariables.getOrientation(n.target.result,function(e){var n=0;e>0&&(5==e||6==e?n=90:3==e||4==e?n=180:7!=e&&8!=e||(n=270)),t.rotation=n})},r.onloadend=function(a){var r=new Image,l=new Uint8Array(a.target.result),s=new Blob([l.buffer]);r.src=URL.createObjectURL(s),r.onload=function(){clearTimeout(i),t.width=this.width,t.height=this.height,e._internalVariables.getFileMetaFinished(n,t)}},r.readAsArrayBuffer(n)},2):(e._internalVariables.consoleError("Can't get Exif data since browser doesn't support FileReader"),e._internalVariables.getFileMetaFinished(n,t));else if(e._internalVariables.isVideo(n.name)&&e.doGetFileMetadata)if("undefined"!=typeof FileReader){var r=document.createElement("video");r.preload="metadata";var i=setTimeout(function(){r.onloadedmetadata=null,e._internalVariables.consoleError("Failed retrieving meta data for '"+a+"'"),e._internalVariables.getFileMetaFinished(n,t)},400);r.onloadedmetadata=function(){clearTimeout(i),window.URL.revokeObjectURL(r.src);var a=null,l=null;null!=r.width&&r.width>0&&(l=r.width),null!=r.videoWidth&&r.videoWidth>0&&(l=r.videoWidth),null!=r.height&&r.height>0&&(a=r.height),null!=r.videoHeight&&r.videoHeight>0&&(a=r.videoHeight),t.duration=r.duration,t.width=l,t.height=a,e._internalVariables.getFileMetaFinished(n,t)},r.src=URL.createObjectURL(n)}else e._internalVariables.consoleError("Can't get file meta data since browser doesn't support FileReader"),e._internalVariables.getFileMetaFinished(n,t);else e._internalVariables.getFileMetaFinished(n,t)},this._internalVariables.getFileMetaFinished=function(e,n){var a=this.instance,t=a._internalVariables.curUploadingFilesData[a._internalVariables.curUploadingFileIndex];if(t.duration=n.duration,t.width=n.width,t.height=n.height,t.rotation=n.rotation,a._internalVariables.curUploadingFilesData.length<=a._internalVariables.curUploadingFileIndex+1||a._internalVariables.curUploadingFileIndex+1>=a.maxFiles){var r=a._internalVariables.validateFiles();0==r.length?("function"==typeof a.onFilesSelected&&a.onFilesSelected(a._internalVariables.curUploadingFilesData),a._internalVariables.curUploadingFileIndex=0,a._internalVariables.onFileProgress(0),a._internalVariables.uploadFile()):a._internalVariables.parseErrors(r)}else a._internalVariables.curUploadingFileIndex++,a._internalVariables.getNextFileMetadata()},this._internalVariables.uploadFile=function(){var e=this.instance;noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").attr("src",""),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").attr("src",""),noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("transition","width 0s"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("-webkit-transition","width 0s"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("width",0),setTimeout(function(){noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("transition","width .2s"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("-webkit-transition","width .2s")},10),-1!=e.progressAnimationType.indexOf("bar")&&noJquery(e.elements.uploaderProgressContainerElement).css("display",""),"iframe"==e._internalVariables.getUploadType()?(noJquery(e.elements.uploaderProgressBarElement).find("div").css("display","none"),noJquery(e.elements.uploaderProgressBarTextElement).css("width","auto"),noJquery(e.elements.uploaderProgressBarPaddingElement).css("display","none")):(noJquery(e.elements.uploaderProgressBarElement).find("div").css("display",""),noJquery(e.elements.uploaderProgressBarTextElement).css("width","1%"),noJquery(e.elements.uploaderProgressBarPaddingElement).css("display","")),noJquery(e.elements.uploaderResultElement).removeClass("error"),e._internalVariables.showCurrentFiles();var n=e._internalVariables.curUploadingFilesData,a=e._internalVariables.curUploadingFileIndex,t="";t=(t=(t=n.length>1&&e.maxFiles>1?e.uploadingFilesTextProgressBar:e.uploadingFileTextProgressBar).split("{{total_files}}").join(Math.min(e._internalVariables.curUploadingFilesData.length,e.maxFiles))).split("{{current_file_name}}").join(e._internalVariables.getShortFilename(n[a].name)),noJquery(e.elements.uploaderProgressBarTextElement).html(t),e._internalVariables.isUploading=!0,noJquery(e.elements.uploaderCancelButton).css("display","block"),e._internalVariables.setProgressDisplay(),noJquery(e.elements.containerElement).find("input").attr("onclick","return false;"),e._internalVariables.setText(),noJquery(e.elements.containerElement).removeClass("dragged_enter"),noJquery(e.elements.containerElement).removeClass("dragged_over"),noJquery(e.elements.containerElement).removeClass("hover"),noJquery(e.elements.containerElement).addClass("uploading"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").css("width",noJquery(e.elements.uploaderDropAreaElement).outerWidth()),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").css("width",noJquery(e.elements.uploaderDropAreaElement).outerWidth());var r=null;"undefined"!=typeof URL&&(r=URL.createObjectURL(n[a].file)),null!=r&&""!=r&&e._internalVariables.isImg(n[a].name)?(noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").attr("src",r).css("display",""),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").attr("src",r).css("display",""),noJquery(e.elements.uploaderDropAreaBottomLayerElement).css("opacity","0"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").unbind("load"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").on("load",function(){noJquery(this).parent().animate({opacity:1},400)}),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).css("opacity","0"),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").unbind("load"),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").on("load",function(){noJquery(this).parent().animate({opacity:1},400)})):(noJquery(e.elements.uploaderDropAreaBottomLayerElement).find("img").attr("src","").css("display","none"),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).find("img").attr("src","").css("display","none"),noJquery(e.elements.uploaderDropAreaBottomLayerElement).animate({opacity:1},400),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).animate({opacity:1},400));var i="";if("chunks"==e._internalVariables.getUploadType()){var l=e._internalVariables.curUploadingFilesData[a];i=e.serverScripts.uploadChunk+"&_="+Math.random();(d=l.name).substr(d.lastIndexOf("."),5);var s=n[a].file,o=Math.floor(999999999*Math.random());e._internalVariables.uploadFileChunk(i,l,o,s,0,0,e._internalVariables.BYTES_PER_CHUNK)}else if("stream"==e._internalVariables.getUploadType()){var d=(l=e._internalVariables.curUploadingFilesData[a]).name,u=new XMLHttpRequest;e._internalVariables.uploadFileChunkXhr=u,u.upload.addEventListener("progress",function(n){n.lengthComputable&&e._internalVariables.onFileProgress(n.loaded/n.total)},!1),u.addEventListener("load",function(){var t=u.responseText;try{e._internalVariables.curUploadingFileIndex++;var r=e._internalVariables.curUploadingFilesData.length<=e._internalVariables.curUploadingFileIndex||e._internalVariables.curUploadingFileIndex>=e.maxFiles;r&&e._internalVariables.curUploadingFileIndex--;var i=JSON.parse(t);function l(){e._internalVariables.parseUploadResult(i,r,n[a].file),!r&&e._internalVariables.curUploadingFilesData.length>0&&e._internalVariables.uploadFile()}null!=e.elements.uploaderDropAreaBottomLayerElement?noJquery(e.elements.uploaderDropAreaBottomLayerElement).animate({opacity:0},200,function(){l()}):l(),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).animate({opacity:0},200)}catch(r){e._internalVariables.setError("upload_failed",n[a],t),e._internalVariables.uploadFileChunkXhr=null}},!1),i=(i=e.serverScripts.uploadStream).split("{{file_name}}").join(d).split("{{rotation}}").join(l.rotation),i+="&_="+Math.random(),u.open("post",i,!0),u.setRequestHeader("Content-Type","multipart/form-data"),u.setRequestHeader("X-File-Name",d),u.setRequestHeader("X-File-Type",l.type),u.send(n[a].file)}else{for(var p="",c=0;c<e._internalVariables.curUploadingFilesData.length;c++)p+=e._internalVariables.curUploadingFilesData[c].rotation,c<e._internalVariables.curUploadingFilesData.length-1&&(p+=",");i=(i=e.serverScripts.uploadThroughIframe).split("{{rotation}}").join(p),e._internalVariables.onFileProgress(0),uploaerIframeGateway.uploadViaIframeGateway(e.elements.elementId,i,window.location.href.substr(0,window.location.href.lastIndexOf("/"))+"/"+e.iframeGateway,function(n){e._internalVariables.curUploadingFileIndex=e._internalVariables.totalFilesToUpload-1,e._internalVariables.onFileProgress(1),null==e.elements.uploaderDropAreaBottomLayerElement?e._internalVariables.parseUploadResult(n,!0,null):noJquery(e.elements.uploaderDropAreaBottomLayerElement).animate({opacity:0},200,function(){e._internalVariables.parseUploadResult(n,!0,null)}),noJquery(e.elements.uploaderDropAreaMiddleLayerElement).animate({opacity:0},200,function(){})})}},this._internalVariables.uploadFileChunk=function(e,n,a,t,r,i,l){var s,o=this.instance,d=t.size;t.slice?s=t.slice(i,l):t.mozSlice?s=t.mozSlice(i,l):t.webkitSlice&&(s=t.webkitSlice(i,l));var u=new XMLHttpRequest;o._internalVariables.uploadFileChunkXhr=u,u.onload=function(){},u.onerror=function(){},u.onreadystatechange=function(s){if(4===u.readyState)if(200===u.status){var p=!1;try{for(var c=JSON.parse(this.response),m=0;m<c.length;m++)if(null!=c[m][o.serverScripts.errorVariableName]&&""!=c[m][o.serverScripts.errorVariableName]){o._internalVariables.setError("upload_failed",n,c[m]),p=!0;break}}catch(e){}if(p)o._internalVariables.abortAndCancelUpload();else{var h=d%o._internalVariables.BYTES_PER_CHUNK==0?d/o._internalVariables.BYTES_PER_CHUNK:Math.floor(d/o._internalVariables.BYTES_PER_CHUNK)+1;null!=o._internalVariables.onFileProgress&&"function"==typeof o._internalVariables.onFileProgress&&o._internalVariables.onFileProgress(r/h),r==h?(o._internalVariables.uploadFileChunkXhr=null,o._internalVariables.uploadFileInChunksComplete(n,a)):(l=(i=l)+o._internalVariables.BYTES_PER_CHUNK,r++,o._internalVariables.isUploading&&o._internalVariables.uploadFileChunk(e,n,a,t,r,i,l))}}else if(0===u.status);else{var f=[];f.push({error:"upload_failed",file:n}),o._internalVariables.parseErrors(f)}};var p=e.split("{{file_name}}").join(n.name).split("{{chunk_index}}").join(r).split("{{request_id}}").join(a);u.open("POST",p),u.send(s)},this._internalVariables.uploadFileInChunksComplete=function(e,n){var a=this.instance,t=a.serverScripts.combineChunks.split("{{file_name}}").join(e.name).split("{{request_id}}").join(n).split("{{rotation}}").join(e.rotation);a._internalVariables.uploadFileChunkXhr=noJquery.ajax({url:t,dataType:"jsonp",success:function(n){a._internalVariables.curUploadingFileIndex++;var t=a._internalVariables.curUploadingFilesData.length<=a._internalVariables.curUploadingFileIndex||a._internalVariables.curUploadingFileIndex>=a.maxFiles;a._internalVariables.parseUploadResult(n,t,e),!t&&a._internalVariables.curUploadingFilesData.length>0&&a._internalVariables.uploadFile(),a._internalVariables.uploadFileChunkXhr=null},error:function(n,t){"abort"===t||a._internalVariables.setError("upload_failed",e),a._internalVariables.uploadFileChunkXhr=null}})},this._internalVariables.onFileProgress=function(e){var n=this.instance,a=Math.min(n._internalVariables.curUploadingFilesData.length,n.maxFiles);if("function"==typeof n.onFilesProgress&&n.onFilesProgress(e,n._internalVariables.curUploadingFileIndex,n._internalVariables.totalFilesToUpload),-1!=n.progressAnimationType.indexOf("bar")){var t=100/a,r=t*n._internalVariables.curUploadingFileIndex+t*e;noJquery(n.elements.uploaderProgressBarColorElement).css("width",r+"%")}-1!=n.progressAnimationType.indexOf("inline")&&(noJquery(n.elements.uploaderDropAreaBottomLayerElement).css("width",Math.ceil(100*e)+"%"),noJquery(n.elements.uploaderDropAreaMiddleLayerElement).css("width",noJquery(n.elements.uploaderDropAreaElement).outerWidth()))},this.cancelUpload=function(){this._internalVariables.abortAndCancelUpload(),"function"==typeof this.onCanceled&&this.onCanceled()},this._internalVariables.abortAndCancelUpload=function(){var e=this.instance;e._internalVariables.curUploadingFilesData=[],null!=e._internalVariables.uploadFileChunkXhr&&(e._internalVariables.uploadFileChunkXhr.abort(),e._internalVariables.uploadFileChunkXhr=null),e._internalVariables.isUploading=!1,e._internalVariables.showUploadBtn(),"iframe"==e._internalVariables.getUploadType()&&uploaerIframeGateway.cancelUpload(e.elements.elementId,e.iframeGateway)},this._internalVariables.parseUploadResult=function(e,n,a){for(var t=this.instance,r=!1,i=0;i<e.length;i++){if(null==e[i][t.serverScripts.fileNameVariableName]||""==e[i][t.serverScripts.fileNameVariableName]){t._internalVariables.setError("upload_failed",a,e[i]),r=!0;break}t.uploadedFiles.push(e[i])}n&&!r&&(t._internalVariables.isUploading=!1,"function"==typeof t.onFilesUploaded&&t.onFilesUploaded(t.uploadedFiles),t._internalVariables.showCurrentFiles(),t._internalVariables.showUploadBtn())},this._internalVariables.showCurrentFiles=function(){var e=this.instance;if(null!=e.elements.uploaderResultElement){clearTimeout(e._internalVariables.displayErrorAnimationTimeoutDuration);if(null==e.uploadedFiles||0==e.uploadedFiles.length)noJquery(e.elements.uploaderResultElement).html("");else{for(var n="",a=0;a<e.uploadedFiles.length;a++){var t=e.uploadedFiles[a];if(null!=t[e.serverScripts.fileNameVariableName]&&""!=t[e.serverScripts.fileNameVariableName]){var r=e.uploadedFileHtml;void 0===r&&(r=""),r=r.split("{{current_file_path}}").join(t[e.serverScripts.fileUrlVariableName]).split("{{current_file_name}}").join(e._internalVariables.getShortFilename(t[e.serverScripts.fileNameVariableName])),n+="<div class='uploader_result_file'>"+"<a class='uploader_delete_btn' data-index='{{index}}' href='javascript: void(0);'><div></div></a>".split("{{index}}").join(a)+"&nbsp;"+r+"</div>"}}noJquery(e.elements.uploaderResultElement).html(n)}var i=e.elements.containerElement.querySelectorAll(".uploader_delete_btn");for(a=0;a<i.length;a++)noJquery(i.item(a)).on("click",function(){e.disabled||e._internalVariables.deleteFile(noJquery(this).attr("data-index"))});noJquery(e.elements.uploaderResultElement).fadeIn()}},this._internalVariables.deleteFile=function(e){var n=this.instance,a=(parseInt(e),n.uploadedFiles.splice(e,1));"function"==typeof n.onFileDeleted&&n.onFileDeleted(a[0],n.uploadedFiles),n._internalVariables.showCurrentFiles()},this._internalVariables.setError=function(e,n,a){var t=this.instance,r=[];r.push({error:e,file:n,error_object:a}),t._internalVariables.parseErrors(r)},this._internalVariables.parseErrors=function(e){for(var n=this.instance,a="",t=0;t<e.length;t++){var r,i=e[t];if(null!=(r="invalid_file_extension"==i.error?n.errors.invalidFileExtension:"invalid_file_size"==i.error?n.errors.invalidFileSize:"upload_failed"==i.error?n.showDetailedErrorFromServer&&null!=i.error_object&&null!=i.error_object.error&&""!=i.error_object.error?i.error_object.error:n.errors.uploadFailed:null!=i.error_text?i.error_text:n.errors.unspecifiedError)){var l=i.file;null!=l&&(r=r.split("{{file_name}}").join(n._internalVariables.getShortFilename(l.name))),i.error_text=r,""!=a&&(a+="<br>"),a+=r}}noJquery(n.elements.uploaderResultElement).addClass("error"),noJquery(n.elements.uploaderResultElement).html(a).css("opacity","0").fadeIn(),n._internalVariables.abortAndCancelUpload(),"function"==typeof n.onError&&n.onError(e),n._internalVariables.hoverOnBtn=!1,n._internalVariables.checkDragFileStates(),clearTimeout(n._internalVariables.displayErrorAnimationTimeoutDuration),n._internalVariables.displayErrorAnimationTimeoutDuration=setTimeout(function(){noJquery(n.elements.uploaderResultElement).fadeOut(function(){n._internalVariables.showCurrentFiles()})},n.displayErrorDuration)},this._internalVariables.consoleError=function(e){var n=!!window.MSInputMethodContext&&!!document.documentMode,a=-1!=navigator.userAgent.indexOf("MSIE");"undefined"!=typeof console&&(n||a?console.warn("Uploader: "+e):console.log("%c Uploader: "+e,"background: #222; color: #bada55; padding: 10px;"))},this._internalVariables.getUploadType=function(){var e=this.instance;if(!e._internalVariables.canUploadFileInchunks()){var n=e._internalVariables.getIEVersion();return e._internalVariables.isCrossDomainScript(e.serverScripts.uploadStream)||n>=0&&n<=9?"iframe":"stream"}return e._internalVariables.isCrossDomainScript(e.serverScripts.uploadStream)?"chunks":navigator.userAgent.indexOf("Edge")>-1?"chunks":"stream"},this._internalVariables.canUploadFileInchunks=function(){var e=this.instance;if(!e.uploadFileInChunks)return!1;if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&e._internalVariables.isCrossDomainScript(e.serverScripts.uploadChunk))return!1;var n=e._internalVariables.getIEVersion();return!(n>=0&&n<=9)},this._internalVariables.isCrossDomainScript=function(e){this.instance;var n=!1;if(0==e.indexOf("http:")||0==e.indexOf("https:")||0==e.indexOf("//")){(e.indexOf("://")>-1?e.split("/")[2]:0==e.indexOf("//")?(e=e.substring(2)).split("/")[0]:e.split("/")[0]).split(":")[0].toLowerCase()!=window.location.host.toLowerCase()&&(n=!0)}return n},this._internalVariables.getIEVersion=function(){var e=-1;return-1!=navigator.appVersion.indexOf("MSIE")&&(e=parseFloat(navigator.appVersion.split("MSIE")[1])),navigator.userAgent.match(/Trident.*rv\:11\./)&&(e=11),e},this._internalVariables.isMobileOrTablet=function(){var e,n=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(n=!0),n},this._internalVariables.videoFileTypes=[".3gp2",".3gpp",".3gpp2",".asf",".asx",".avi",".flv",".m4v",".mkv",".mov",".mpeg",".mpg",".mpe",".m1s",".mpa",".mp2",".m2a",".mp2v",".m2v",".m2s",".mp4",".ogg",".rm",".wmv",".mp4",".qt",".ogm",".vob",".webm",".787",".ogv"],this._internalVariables.imageFileTypes=[".jpg",".jpeg",".png",".tiff",".bmp",".gif"],this._internalVariables.isFileType=function(e,n){var a=e.substr(e.lastIndexOf("."),5);return a=a.toLowerCase(),-1!=noJquery.inArray(a.toLowerCase(),n)},this._internalVariables.isImg=function(e){var n=this.instance;return n._internalVariables.isFileType(e,n._internalVariables.imageFileTypes)},this._internalVariables.isVideo=function(e){var n=this.instance;return n._internalVariables.isFileType(e,n._internalVariables.videoFileTypes)},this._internalVariables.isDropFilesEnabled=function(){var e=this.instance,n=navigator.userAgent;if(!e.enableDropFiles)return!1;if(-1!=n.indexOf("MSIE")&&-1==n.indexOf("MSIE 10.0"))return!1;var a=e._internalVariables.getIEVersion();return(!(/Edge/.test(navigator.userAgent)||a>=0)||"iframe"!=e._internalVariables.getUploadType())&&!e._internalVariables.isMobileOrTablet()},this._internalVariables.validateIframeGatewayPath=function(){var e=this.instance,n=window.location.href.substr(0,window.location.href.lastIndexOf("/"))+"/"+e.iframeGateway;noJquery.ajax({type:"HEAD",url:n,success:function(e){},error:function(a,t){e._internalVariables.consoleError("Iframe gateway can't be found at "+n)}})},this._internalVariables.getOrientation=function(e,n){if(view=new DataView(e),65496!=view.getUint16(0,!1))return n(-2);for(var a=view.byteLength,t=2;t<a;){if(view.getUint16(t+2,!1)<=8)return n(-1);var r=view.getUint16(t,!1);if(t+=2,65505==r){if(1165519206!=view.getUint32(t+=2,!1))return n(-1);var i=18761==view.getUint16(t+=6,!1);t+=view.getUint32(t+4,i);var l=view.getUint16(t,i);t+=2;for(var s=0;s<l;s++)if(274==view.getUint16(t+12*s,i))return n(view.getUint16(t+12*s+8,i))}else{if(65280!=(65280&r))break;t+=view.getUint16(t,!1)}}return n(-1)},this._internalVariables.build()}var uploaerIframeGateway={objs:[],uploaderIframeActionCompleted:function(e,n){var a=this.objs[e];a.uploaderIframeActionCompletedCalled||(a.uploaderIframeActionCompletedCalled=!0,null!=a.actionCompletedFunc&&a.actionCompletedFunc(n),noJquery("iframe[data-request='"+e+"']").remove())},uploadViaIframeGateway:function(e,n,a,t){var r=Math.floor(999999999*Math.random()),i=new Object;i.closed=!1,i.actionCompletedFunc=t,uploaerIframeGateway.objs[r]=i;var l="uploader_gateway_iframe_"+e;null==noJquery("#"+l).get(0)&&noJquery("<iframe id='"+l+"' data-request='"+r+"' name='"+l+"' style='width: 1px; height: 1px; opacity: 0; display: none;'>").appendTo("body");var s=n;-1!=s.indexOf("?")?s+="&":s+="?",s=s.split("{{request_id}}").join(r).split("{{iframe_gateway}}").join(a),0==(s+="_="+Math.random()).indexOf("//")&&(s=window.location.protocol+s),noJquery("#"+e).attr("action",s).attr("target",l).attr("enctype","multipart/form-data").attr("method","post").get(0).submit()},cancelUpload:function(e,n){var a="uploader_gateway_iframe_"+e,t=n;null==noJquery("#"+a).get(0)&&noJquery("<iframe id='"+a+"' name='"+a+"' style='width: 1px; height: 1px; opacity: 0; display: none;'>").appendTo("body");noJquery("#"+e).attr("action",t).attr("target",a).attr("enctype","multipart/form-data").attr("method","get").get(0).submit()}};function noJquery(e){if(!(this instanceof noJquery))return new noJquery(e);if("function"==typeof e)return e.call(document);if(this.length=0,this.nodes=[],"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)this.nodes=e.length>1?[].slice.call(e):[e];else if("string"==typeof e)if(0==e.indexOf("<")){var n=document.createElement("div");n.innerHTML=e,this.nodes=[n.firstChild]}else{this.nodes=[];for(var a=document.querySelectorAll(e),t=0;t<a.length;t++)this.nodes.push(a.item(t))}if(this.nodes.length){this.length=this.nodes.length;for(t=0;t<this.nodes.length;t++)this[t]=this.nodes[t]}}noJquery.fn=noJquery.prototype,noJquery.fn.each=function(e){for(var n=0;n<this.length;n++)e.call(this[n],this,n);return this},noJquery.fn.hasClass=function(e){for(var n=!1,a=0;a<this.nodes.length;a++)this.nodes[a].classList?this.nodes[a].classList.contains(e)&&(n=!0):new RegExp("(^| )"+e+"( |$)","gi").test(this.nodes[a].className)&&(n=!0);return n},noJquery.fn.addClass=function(e){if(!this.hasClass(e))for(var n=0;n<this.nodes.length;n++)this.nodes[n].className=this.nodes[n].className.trim()+" "+e;return this},noJquery.fn.removeClass=function(e){return this.each(function(){this.className=this.className.replace(new RegExp("\\b"+e+"\\b","g"),"")}),this},noJquery.fn.text=function(e){return void 0===e&&(e=""),this.each(function(){this.innerText=e})},noJquery.fn.html=function(e){if(null==e||void 0===e)return null!=this.nodes&&this.nodes.length>0?this.nodes[0].innerHTML:null;for(var n=0;n<this.nodes.length;n++)this.nodes[n].innerHTML=e;return this},noJquery.fn.css=function(e,n){if(void 0!==e)for(var a=0;a<this.nodes.length;a++)if("width"!=e&&"left"!=e&&"top"!=e||isNaN(n)||(n+="px"),-1!=e.indexOf("-")){var t=e.split("-");t.length>1&&(t[1]=t[1].charAt(0).toUpperCase()+t[1].slice(1)),this.nodes[a].style[t.join("")]=n}else this.nodes[a].style[e]=n;return this},noJquery.events=[],noJquery.fn.on=function(e,n){for(var a=(e=e.split(" ").join("")).split(","),t=0;t<a.length;t++)this.each(function(){var r={elem:this,name:e,handler:function(e){e.originalEvent=e,null==e.pageX&&null!=e.clientX&&(-1!=navigator.appVersion.indexOf("MSIE")&&8==parseFloat(navigator.appVersion.split("MSIE")[1])?(e.pageX=e.clientX,e.pageY=e.clientY):(eventDoc=e.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,e.pageX=e.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),e.pageY=e.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0))),n.call(this,e)}};this.addEventListener(a[t],r.handler,!1),noJquery.events.push(r)});return this},noJquery.fn.unbind=function(e){for(var n=(e=e.split(" ").join("")).split(","),a=0;a<n.length;a++)this.each(function(){for(var t=0;t<noJquery.events.length;t++)noJquery.events[t].elem==this&&noJquery.events[t].name==e&&this.removeEventListener(n[a],noJquery.events[t].handler,!1)});return this},noJquery.fn.appendTo=function(e){return null!=this.nodes&&this.nodes.length>0&&document.querySelector(e).appendChild(this.nodes[0]),this},noJquery.fn.append=function(e){for(var n=0;n<this.nodes.length;n++)this.nodes[n].appendChild(e);return this},noJquery.fn.find=function(e){return null!=this.nodes&&this.nodes.length>0?new noJquery(this.nodes[0].querySelector(e)):this},noJquery.fn.attr=function(e,n){if(void 0===n)return null!=this.nodes&&this.nodes.length>0?this.nodes[0].getAttribute(e):null;for(var a=0;a<this.nodes.length;a++)this.nodes[a].setAttribute(e,n);return this},noJquery.fn.removeAttr=function(e){for(var n=0;n<this.nodes.length;n++)this.nodes[n].removeAttribute(e);return this},noJquery.fn.get=function(e){return null==this.nodes||0==this.nodes.length?null:this.nodes[e]},noJquery.fn.remove=function(){return null!=this.nodes&&this.nodes.length>0&&this.nodes[0].parentNode.removeChild(this.nodes[0]),this},noJquery.fn.parent=function(){return null!=this.nodes&&this.nodes.length>0&&(this.nodes=[this.nodes[0].parentNode]),this},noJquery.fn.outerWidth=function(){return null!=this.nodes&&this.nodes.length>0?this.nodes[0].offsetWidth:null},noJquery.fn.outerHeight=function(){return null!=this.nodes&&this.nodes.length>0?this.nodes[0].outerHeight:null},noJquery.fn.offset=function(){if(null!=this.nodes&&this.nodes.length>0){var e=this.nodes[0].getBoundingClientRect(),n=window.pageYOffset||document.body.scrollTop,a=window.pageXOffset||document.body.scrollLeft;return{top:e.top+n,left:e.left+a}}return null},noJquery.animations=[],noJquery.getAnimationByElementAndType=function(e,n){for(var a=0;a<noJquery.animations.length;a++)if(noJquery.animations[a].element==e&&noJquery.animations[a].animationType==n)return noJquery.animations[a];return curAnimation={element:e,animationType:n,animationFrame:null,timeout:null},noJquery.animations.push(curAnimation),curAnimation},noJquery.fn.fadeIn=function(e){this.animate({opacity:1},400,e)},noJquery.fn.fadeOut=function(e){this.animate({opacity:0},400,e)},noJquery.fn.animate=function(e,n,a){for(var t=0;t<this.nodes.length;t++){var r=this.nodes[t],i=0,l=0;for(var s in e){"opacity"==s&&void 0!==window.getComputedStyle&&(i=parseInt(window.getComputedStyle(r).getPropertyValue("opacity")),l=i<e[s]?1:-1);var o=noJquery.getAnimationByElementAndType(r,s);null!=o&&(null!=o.animationFrame&&window.cancelAnimationFrame(o.animationFrame),null!=o.timeout&&(clearTimeout(o.timeout),o.timeout=null))}var d=new Date;d.setMilliseconds(d.getMilliseconds()+n);var u=function(){for(var t in e){var s=noJquery.getAnimationByElementAndType(r,t);if("opacity"==t){var o=i+(e[t]-i)*(1-(d-new Date)/n);r.style.opacity=o,r.style.filter="alpha(opacity="+100*o|"0)",l>0&&o<e[t]||l<=0&&o>e[t]?window.requestAnimationFrame?s.animationFrame=requestAnimationFrame(u):s.timeout=setTimeout(u,16):(r.style.opacity=e[t],r.style.filter="alpha(opacity="+100*e[t]|"0)","function"==typeof a&&a())}}};u()}},noJquery.inArray=function(e,n){for(var a=0;a<n.length;a++)if(n[a]===e)return a;return-1},noJquery.extend=function(e){e=e||{};for(var n=1;n<arguments.length;n++)if(arguments[n])for(var a in arguments[n])arguments[n].hasOwnProperty(a)&&(e[a]=arguments[n][a]);return e},noJquery.ajax=function(e){if("jsonp"==e.dataType)return noJquery.jsonp(e);if("HEAD"==e.type){var n={},a=new XMLHttpRequest;return a.open(e.type,e.url),a.onreadystatechange=function(n){4===a.readyState&&(200===a.status?"function"==typeof e.success&&e.success(this.response):0===a.status?"function"==typeof e.error&&e.error(a,"abort"):"function"==typeof e.error&&e.error(a,"error"))},a.send(),n.xhr=n,n}return null},noJquery.jsonp=function(e){var n={},a="jsonp_callback_"+Math.round(1e5*Math.random()),t=document.createElement("script");return t.src=e.url+(e.url.indexOf("?")>=0?"&":"?")+"callback="+a,window[a]=function(n){window[a]=function(){},document.body.removeChild(t),t=null,e.success,e.success(n)},e.error,t.addEventListener("error",e.error),document.body.appendChild(t),n.abort=function(){window[a]=function(){};try{document.body.removeChild(t)}catch(e){}t=null,e.error,e.error(null,"abort")},n},window.noJquery=noJquery,"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()||(Object.defineProperty=function(e,n,a){if("get"in a&&"function"==typeof a.get)return a.get();"set"in a&&"function"==typeof a.set&&a.set()}),!window.addEventListener&&function(e,n,a,t,r,i,l){e[t]=n[t]=a[t]=function(e,n){var a=this;l.unshift([a,e,n,function(e){e.currentTarget=a,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||a,n.call(a,e)}]),this.attachEvent("on"+e,l[0][3])},e[r]=n[r]=a[r]=function(e,n){for(var a,t=0;a=l[t];++t)if(a[0]==this&&a[1]==e&&a[2]==n)return this.detachEvent("on"+e,l.splice(t,1)[0][3])},e[i]=n[i]=a[i]=function(e){return this.fireEvent("on"+e.type,e)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]);
